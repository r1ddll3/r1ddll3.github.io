<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><meta name=keywords content="SOC,Windows Logging"><meta name=author content="@R1ddl3"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="CTFS - Security Blog | Hacking | Malware Analysis | SOC Analyst | Blue Team | Defenders"><meta name=yandex-verification content="CTFS - Security Blog | Hacking | Malware Analysis | SOC Analyst | Blue Team | Defenders"><meta name=msvalidate.01 content="CTFS - Security Blog | Hacking | Malware Analysis | SOC Analyst | Blue Team | Defenders"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><link crossorigin=anonymous href=/css/core/vendorStyle.css integrity rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://i.ibb.co/DWKRt3n/b.png><link rel=icon type=image/png sizes=16x16 href=https://r1ddll3.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://r1ddll3.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://r1ddll3.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://r1ddll3.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="How Windows Logging Work"><meta property="og:description" content="How Windows Logging Work."><meta property="og:type" content="article"><meta property="og:url" content="https://r1ddll3.github.io/dfir/soc-tips/windows-logging/"><meta property="og:image" content="https://i.imgur.com/jAF65TO.png"><meta property="article:section" content="DFIR"><meta property="article:published_time" content="2022-10-28T00:23:50+02:00"><meta property="article:modified_time" content="2022-10-28T00:23:50+02:00"><meta property="og:site_name" content="R1ddl3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://i.imgur.com/jAF65TO.png"><meta name=twitter:title content="How Windows Logging Work"><meta name=twitter:description content="How Windows Logging Work."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"DFIRs","item":"https://r1ddll3.github.io/dfir/"},{"@type":"ListItem","position":3,"name":"How Windows Logging Work","item":"https://r1ddll3.github.io/dfir/soc-tips/windows-logging/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How Windows Logging Work","name":"How Windows Logging Work","description":"How Windows Logging Work.","keywords":["SOC","Windows Logging"],"articleBody":"Hey folks, Today i will talk about How Windows Logging Work\nLet’s Dive in!!\nFirst of all we should know the Importance of Understanding Log Collection.\nwe know that log collection is SIEM’s duty but as an analyst that want to improve his capability you should know how your windows store these logs and how to see it real-time and how to read it…etc\n1- improve your capability as an analyst not just an analyst who uses some tools without know the root about these tools.\n2- Understanding logs is understanding the available tools.\nso let’s get back to answer the question:\nLogs are records of events that happen in your computer, either by a person or by a running process. They help you track what happened and troubleshoot problems.\nEvent Viewer The Windows Event Logs are not text files that can be viewed using a text editor. However, the data are XML-formatted .evtx files and they stored in C:\\Windows\\System32\\winevt\\Logs\n- Note: File must be interpreted with tool - Cannot read directly like linux log text files There are 3 main ways of accessing these event logs within a Windows system:\nEvent Viewer (GUI-based application) Wevtutil.exe (command-line tool) Get-WinEvent (PowerShell cmdlet) i will explain Event Viewer and Get-WinEvent, let’s talk about event viewer first\nwe can open it using windows search and type event viewer or you can right-click on windows icon and select event viewer or we can use CLI and type eventvwr.msc\nso after open event viewer we will see the following:\nEvent Viewer has an intuitive user interface. The main screen is divided into three sections:\nThe pane on the left provides a hierarchical tree listing of the event log providers and they called ( channels ). The pane in the middle will either display a general overview and summary or the events specific to a selected channel. The pane on the right is the actions pane. 1- Channels Pane The Channels pane is where you choose the event log to view. By default, there are five channels of Windows logs More info Microsoft :\nApplication – Information logged by applications hosted on the local machine.\nSecurity – Information related to login attempts (success and failure), elevated privileges, and other audited events.\nSetup – Messages generated when installing and upgrading the Windows operating system. If the Windows system is a domain controller, those messages are also logged here.\nSystem – Messages generated by the Windows operating system.\nForwarded Events – Events forwarded by other computers when the local machine is functioning as a central subscriber.\nThere is also a section for Applications and Services Logs, including channels for Hardware Events, Internet Explorer and Windows PowerShell events, windows defender events..etc, you better take a look by yourself.\nactually these channels are files they are .evtx files stored in your system you can try to read them by right-clicking on any channel then choose properties you will see all the details about the channel\nOne other thing you should know before dive into next pane, What is the Windows Log Path?\nFrom prev photo we noticed that there is something in the middle called Windows Event Log Service, this the service that allowed the windows to record all your logs so if you want to know if it enabled or no you can check it by typing Services in windows search and navigate to windows event log and you should see the following\nif you noticed it is enabled by default and in the left the description of the service and what it does,\nafter gets the data will filter the data based on their channels and we have discussed the channels… for example: found a logon attempt so it will put the log in the security channel because this channel is holding the logon attempts success and failure and so on… Let’s Continue\n2- Detail pane There are 5 types of events that can be logged. Below is a table from docs.microsoft.com providing a brief description for each.\nEach event has a type Level:\nFocus your attention on the middle pane. Remember from earlier that this pane will display the events specific to a selected provider In this case, Security Channel.\nselect security channel.\nThis section has 2 tabs: General and Details.\nGeneral is the default view, and the rendered data is displayed. The Details view has 2 options: Friendly view and XML view. in XML view this what the log actually looks like, and if you want to see the real fields that your SIEM agent will picking up and dealing with they are inside XML view\nNow Let’s Dive into Practical Example. as an analyst i want to see the logon attempts that will happen on my PC either success and failure\nFirst thing i have to know what Information Gets Written, to know if it configured or not, these are the sources the logs getting written from\nas I said I want to know the logon attempts so from prev photo i should go to Local Security Policy and search for logon service to configure it to audit the logon attempts:\nit is not configured so i have to configure it: right-click on it then properties\nfirst let’s navigate to explain section to see what is does it allows me to audit all events that are belong to logon attempts on the computer… that what we’re looking for, next thing is to configure it on success and failure attempts from policy section.\nmark this 2 options to audit success and failure and now let’s try to login\nthere are no logs yet now i will lock my pc and try to login but i will type wrong password 1 time to see the both success and failure logs.\nnow i got a lot of logs\nNote: success and failure each of them has a unique EventID that you can use it to get all the events related to them\nthis a list of Microsoft Event IDS Microsoft\nEvent ID Potential Criticality Event Summary 4624 Low An account was successfully logged on. 4625 Low An account failed to log on. now i can use 4625 to see the failure login attempts.\ni got 1 log after filtering the logs which includes these details Failure Reason: is reason that happened to make the process failed like in login i typed wrong password, take a look at all the highlighted texts and understand it well.\nnow time to see the success log details using this event id: 4624\ni got many more logs but we will depend on the time\nIf you noticed i highlighted common thing between them something called: Logon Type: 5 or 2\nwhat is the logon type then: the type of logon which was performed. The table below contains the list of possible values for this field.\nI Will Leave to You the Last pane discover it by yourself and now let’s move to something else\nNew Scheduled Task Event ID: 4698 Event ID Potential Criticality Event Summary 4698 Low A scheduled task was created. 4699 Low A scheduled task was deleted. 4700 Low A scheduled task was enabled. 4701 Low A scheduled task was disabled. 4702 Low A scheduled task was updated. Service Creation: Windows Event ID 7045 Actually this Event ID is not listed in Microsoft Events ID but Service Creation is another way the attackers use for persistence or use the computer resources for mining cryptocurrency\nUSB Plug \u0026 Play: Event ID 6416 In order to track if there is any devices that plugged in into your PC follow those steps:\n1- Enable the USB Logging option by accessing the Event Viewer:\nBy going to Local Security Policy read the explain first to know what is does and then enable success and failure\nnow back to event viewr and use the Event ID\nWindows Defender: Event IDs 1006 / 1116 This an example for windows defender when i ran a malicious file on my pc and i was enable real-time protection windows defender made an alert and log this event you can see windows defender logs from\nApplications and Services Logs \u003e Microsoft \u003e Windows \u003e Windows Defender \u003e Operational\nPowerShell Logs: Windows Event ID 4104 So First we need to turn audit policy on by follow those steps:\n1- go to edit group policy \u003e Administrative Templates \u003e Windows Components \u003e Windows PowerShell\n2- we will pick Turn on PowerShell Script Block Logging\nthen turn it on like this\nafter this back to event viewer and navigate to Applications and Services Logs \u003e Microsoft \u003e Windows \u003e PowerShell \u003e Operational to see the logs, once you opened the powershell and filter the logs by its event id yo’ll notice that there is a log has fade in it tells you powershell opened\nthen write any command in my case i will use whoami\nBONUS if you arrived here, i want to tell you good job you made a big progress :D\nLast thing in this topic about Get-WinEvent PowerShell Command\nIf you want to get Details For Specific Event ID you can use the following commands:\n$logs = Get-WinEvent -ListProvider Microsoft-Windows-Security-Auditing then:\n$logs.events | where-object {$_.id -eq EVENT_ID} | fl * – Don’t Forget to Replace EVENT_ID with the event id that you want to get data about.\nChannels of Interest for the analyst Mapping ATT\u0026CK to Windows Event IDs Indicators of attack (IOA) uses security operations to identify risks and map them to the most appropriate attack. In order to address different security scenarios with your SIEM, the link below maps Windows Event ID by tactic and technique.\n©️ Author/Credits: @mdecrevoisier\nEVTX-to-MITRE-Attack\nSummary – Resources i used for this topic\nSANS loggly Microsoft – Thanks For Reading..\n– Wait For Part 2 More Details Kerberos Authentication\n","wordCount":"1637","inLanguage":"en","image":"https://i.imgur.com/jAF65TO.png","datePublished":"2022-10-28T00:23:50+02:00","dateModified":"2022-10-28T00:23:50+02:00","author":{"@type":"Person","name":"@R1ddl3"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://r1ddll3.github.io/dfir/soc-tips/windows-logging/"},"publisher":{"@type":"Organization","name":"R1ddl3","logo":{"@type":"ImageObject","url":"https://i.ibb.co/DWKRt3n/b.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://r1ddll3.github.io accesskey=h title="R1ddl3 (Alt + H)"><img src=https://r1ddll3.github.io/apple-touch-icon.png alt aria-label=logo height=35>R1ddl3</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://r1ddll3.github.io/ctfs/ title=CTFs><span>CTFs</span></a></li><li><a href=https://r1ddll3.github.io/dfir/ title=DFIR><span>DFIR</span></a></li><li><a href=https://r1ddll3.github.io/malware-analysis/ title="Malware Analysis"><span>Malware Analysis</span></a></li><li><a href=https://r1ddll3.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://r1ddll3.github.io/threatintel/ title="Threat Intel"><span>Threat Intel</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://r1ddll3.github.io>Home</a>&nbsp;»&nbsp;<a href=https://r1ddll3.github.io/dfir/>DFIRs</a></div><h1 class=post-title>How Windows Logging Work</h1><div class=post-description>How Windows Logging Work.</div><div class=post-meta><span title='2022-10-28 00:23:50 +0200 +0200'>October 28, 2022</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1637 words&nbsp;·&nbsp;@R1ddl3</div></header><div class=post-content><p>Hey folks, Today i will talk about How Windows Logging Work</p><p>Let&rsquo;s Dive in!!</p><hr><p>First of all we should know the Importance of Understanding Log Collection.</p><p>we know that log collection is SIEM&rsquo;s duty but as an analyst that want to improve his capability you should know how your windows store these logs and how to see it real-time and how to read it&mldr;etc</p><p>1- improve your capability as an analyst not just an analyst who uses some tools without know the root about these tools.</p><p>2- Understanding logs is understanding the available tools.</p><p>so let&rsquo;s get back to answer the question:</p><p><strong>Logs are records of events that happen in your computer, either by a person or by a running process. They help you track what happened and troubleshoot problems.</strong></p><h2 id=event-viewer><strong>Event Viewer</strong><a hidden class=anchor aria-hidden=true href=#event-viewer>#</a></h2><p>The Windows Event Logs are not text files that can be viewed using a text editor. However, the data are XML-formatted <code>.evtx</code> files and they stored in <code>C:\Windows\System32\winevt\Logs</code></p><pre><code>- Note: File must be interpreted with tool
- Cannot read directly like linux log text files
</code></pre><p>There are 3 main ways of accessing these event logs within a Windows system:</p><ol><li><strong>Event Viewer</strong> (GUI-based application)</li><li><strong>Wevtutil.exe</strong> (command-line tool)</li><li><strong>Get-WinEvent</strong> (PowerShell cmdlet)</li></ol><p>i will explain <strong>Event Viewer</strong> and <strong>Get-WinEvent</strong>, let&rsquo;s talk about event viewer first</p><p>we can open it using windows search and type event viewer or you can right-click on windows icon and select event viewer or we can use CLI and type <code>eventvwr.msc</code></p><p>so after open event viewer we will see the following:</p><p>Event Viewer has an intuitive user interface. The main screen is divided into three sections:</p><ul><li>The pane on the left provides a hierarchical tree listing of the event log providers and they called ( channels ).</li><li>The pane in the middle will either display a general overview and summary or the events specific to a selected channel.</li><li>The pane on the right is the actions pane.</li></ul><p><img loading=lazy src=https://i.imgur.com/PVcVh5a.png alt="enter image description here"></p><h2 id=1--channels-pane>1- Channels Pane<a hidden class=anchor aria-hidden=true href=#1--channels-pane>#</a></h2><p>The Channels pane is where you choose the event log to view. By default, there are five channels of Windows logs More info <a href=https://learn.microsoft.com/en-us/windows/win32/eventlog/eventlog-key>Microsoft</a> :</p><ul><li><p>Application – Information logged by applications hosted on the local machine.</p></li><li><p>Security – Information related to login attempts (success and failure), elevated privileges, and other audited events.</p></li><li><p>Setup – Messages generated when installing and upgrading the Windows operating system. If the Windows system is a domain controller, those messages are also logged here.</p></li><li><p>System – Messages generated by the Windows operating system.</p></li><li><p>Forwarded Events – Events forwarded by other computers when the local machine is functioning as a central subscriber.</p></li></ul><p>There is also a section for Applications and Services Logs, including channels for Hardware Events, Internet Explorer and Windows PowerShell events, windows defender events..etc, you better take a look by yourself.</p><p>actually these channels are files they are <code>.evtx</code> files stored in your system you can try to read them by right-clicking on any channel then choose properties you will see all the details about the channel</p><p><img loading=lazy src=https://i.imgur.com/ewD0iZw.png alt="enter image description here"></p><p><strong>One other thing you should know before dive into next pane</strong>, What is the Windows Log Path?</p><p><img loading=lazy src=https://i.imgur.com/vCvjKYl.png alt="enter image description here"></p><p><strong>From prev photo we noticed that there is something in the middle called Windows Event Log Service, this the service that allowed the windows to record all your logs so if you want to know if it enabled or no you can check it by typing Services in windows search and navigate to windows event log and you should see the following</strong></p><p><img loading=lazy src=https://i.imgur.com/eR178ir.png alt="enter image description here"></p><p>if you noticed it is enabled by default and in the left the description of the service and what it does,</p><p>after gets the data will filter the data based on their channels and we have discussed the channels&mldr; for example: found a logon attempt so it will put the log in the <code>security</code> channel because this channel is holding the logon attempts success and failure and so on&mldr; Let&rsquo;s Continue</p><h2 id=2--detail-pane>2- Detail pane<a hidden class=anchor aria-hidden=true href=#2--detail-pane>#</a></h2><p>There are 5 types of events that can be logged. Below is a table from <a href=https://docs.microsoft.com/en-us/windows/win32/eventlog/event-types>docs.microsoft.com</a> providing a brief description for each.</p><p>Each event has a type <strong>Level</strong>:</p><p><img loading=lazy src=https://assets.tryhackme.com/additional/win-event-logs/five-event-types.png alt></p><p><img loading=lazy src=https://i.imgur.com/yDzm8rn.png alt="enter image description here"></p><p><img loading=lazy src=https://i.imgur.com/lRmgNa6.png alt="enter image description here"></p><p>Focus your attention on the middle pane. Remember from earlier that this pane will display the events specific to a selected provider
In this case, <strong>Security Channel</strong>.</p><p>select security channel.</p><p><img loading=lazy src=https://i.imgur.com/mqzOOvW.png alt></p><p>This section has 2 tabs: <strong>General</strong> and <strong>Details</strong>.</p><ul><li>General is the default view, and the rendered data is displayed.</li><li>The Details view has 2 options: Friendly view and XML view.</li></ul><p>in XML view this what the log actually looks like, and if you want to see the real fields that your SIEM agent will picking up and dealing with they are inside XML view</p><h3 id=now-lets-dive-into-practical-example>Now Let&rsquo;s Dive into Practical Example.<a hidden class=anchor aria-hidden=true href=#now-lets-dive-into-practical-example>#</a></h3><p>as an analyst i want to see the logon attempts that will happen on my PC either success and failure</p><p>First thing i have to know what Information Gets Written, to know if it configured or not, these are the sources the logs getting written from</p><p><img loading=lazy src=https://i.imgur.com/X4nNSUC.png alt="enter image description here"></p><p>as I said I want to know the logon attempts so from prev photo i should go to Local Security Policy and search for logon service to configure it to audit the logon attempts:</p><p><img loading=lazy src=https://i.imgur.com/3jQDrja.png alt="enter image description here">
it is not configured so i have to configure it: right-click on it then properties</p><p>first let&rsquo;s navigate to explain section to see what is does
<img loading=lazy src=https://i.imgur.com/BQmi0CT.png alt="enter image description here">
it allows me to audit all events that are belong to logon attempts on the computer&mldr;
that what we&rsquo;re looking for, next thing is to configure it on success and failure attempts from policy section.</p><p><img loading=lazy src=https://i.imgur.com/LQsmvHe.png alt="enter image description here"></p><p>mark this 2 options to audit success and failure and now let&rsquo;s try to login</p><p><img loading=lazy src=https://i.imgur.com/wvU14hB.png alt="enter image description here"></p><p>there are no logs yet now i will lock my pc and try to login but i will type wrong password 1 time to see the both success and failure logs.</p><p><img loading=lazy src=https://i.imgur.com/U0FT0rS.png alt></p><p>now i got a lot of logs</p><p><strong>Note: success and failure each of them has a unique EventID that you can use it to get all the events related to them</strong></p><p><strong>this a list of Microsoft Event IDS <a href=https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/appendix-l--events-to-monitor>Microsoft</a></strong></p><table><thead><tr><th>Event ID</th><th>Potential Criticality</th><th>Event Summary</th></tr></thead><tbody><tr><td>4624</td><td>Low</td><td>An account was successfully logged on.</td></tr><tr><td>4625</td><td>Low</td><td>An account failed to log on.</td></tr></tbody></table><p>now i can use 4625 to see the failure login attempts.</p><p><img loading=lazy src=https://i.imgur.com/GPB7g9d.png alt="enter image description here"></p><p>i got 1 log after filtering the logs which includes these details
<img loading=lazy src=https://i.imgur.com/Hcn0INA.png alt="enter image description here"></p><p>Failure Reason: is reason that happened to make the process failed like in login i typed wrong password, take a look at all the highlighted texts and understand it well.</p><p>now time to see the success log details using this event id: 4624</p><p>i got many more logs but we will depend on the time</p><p><img loading=lazy src=https://i.imgur.com/GoaYIvD.png alt="enter image description here"></p><p>If you noticed i highlighted common thing between them something called: <strong>Logon Type: 5 or 2</strong></p><p>what is the logon type then: <strong>the type of logon which was performed. The table below contains the list of possible values for this field.</strong></p><p><img loading=lazy src=https://i.imgur.com/gZkGlfH.png alt="enter image description here"></p><p><strong>I Will Leave to You the Last pane discover it by yourself and now let&rsquo;s move to something else</strong></p><h2 id=new-scheduled-task-event-id-4698>New Scheduled Task Event ID: 4698<a hidden class=anchor aria-hidden=true href=#new-scheduled-task-event-id-4698>#</a></h2><p><img loading=lazy src=https://i.imgur.com/m1FwdUM.png alt></p><table><thead><tr><th>Event ID</th><th>Potential Criticality</th><th>Event Summary</th></tr></thead><tbody><tr><td>4698</td><td>Low</td><td>A scheduled task was created.</td></tr><tr><td>4699</td><td>Low</td><td>A scheduled task was deleted.</td></tr><tr><td>4700</td><td>Low</td><td>A scheduled task was enabled.</td></tr><tr><td>4701</td><td>Low</td><td>A scheduled task was disabled.</td></tr><tr><td>4702</td><td>Low</td><td>A scheduled task was updated.</td></tr></tbody></table><h2 id=service-creation-windows-event-id-7045>Service Creation: Windows Event ID 7045<a hidden class=anchor aria-hidden=true href=#service-creation-windows-event-id-7045>#</a></h2><p>Actually this Event ID is not listed in Microsoft Events ID but Service Creation is another way the attackers use for persistence or use the computer resources for mining cryptocurrency</p><p><img loading=lazy src=https://i.imgur.com/K2uUMQZ.png alt></p><h2 id=usb-plug--play-event-id-6416>USB Plug & Play: Event ID 6416<a hidden class=anchor aria-hidden=true href=#usb-plug--play-event-id-6416>#</a></h2><p>In order to track if there is any devices that plugged in into your PC follow those steps:</p><p>1- Enable the USB Logging option by accessing the Event Viewer:</p><ul><li>By going to Local Security Policy</li></ul><p><img loading=lazy src=https://i.imgur.com/dBAcBES.png alt></p><p>read the explain first to know what is does and then enable success and failure</p><p>now back to event viewr and use the Event ID</p><p><img loading=lazy src=https://i.imgur.com/HHhmFKX.png alt></p><p><img loading=lazy src=https://i.imgur.com/2V1cfBu.png alt></p><h2 id=windows-defender-event-ids-1006--1116>Windows Defender: Event IDs 1006 / 1116<a hidden class=anchor aria-hidden=true href=#windows-defender-event-ids-1006--1116>#</a></h2><p>This an example for windows defender when i ran a malicious file on my pc and i was enable real-time protection windows defender made an alert and log this event you can see windows defender logs from</p><p><code>Applications and Services Logs > Microsoft > Windows > Windows Defender > Operational</code></p><p><img loading=lazy src=https://i.imgur.com/SSqVYkQ.png alt="enter image description here"></p><h2 id=powershell-logs-windows-event-id-4104>PowerShell Logs: Windows Event ID 4104<a hidden class=anchor aria-hidden=true href=#powershell-logs-windows-event-id-4104>#</a></h2><p>So First we need to turn audit policy on by follow those steps:</p><p>1- go to edit group policy > Administrative Templates > Windows Components > Windows PowerShell</p><p>2- we will pick Turn on PowerShell Script Block Logging</p><p>then turn it on like this</p><p><img loading=lazy src=https://i.imgur.com/zkvCdI9.png alt></p><p>after this back to event viewer and navigate to <code>Applications and Services Logs > Microsoft > Windows > PowerShell > Operational</code> to see the logs, once you opened the powershell and filter the logs by its event id yo&rsquo;ll notice that there is a log has fade in it tells you powershell opened</p><p><img loading=lazy src=https://i.imgur.com/pkWhCjY.png alt></p><p><strong>then write any command in my case i will use whoami</strong></p><p><img loading=lazy src=https://i.imgur.com/Ybvgtld.png alt></p><h2 id=bonus>BONUS<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><p>if you arrived here, i want to tell you good job you made a big progress :D</p><p>Last thing in this topic about <code>Get-WinEvent</code> PowerShell Command</p><p>If you want to get Details For Specific Event ID you can use the following commands:</p><pre><code>$logs = Get-WinEvent -ListProvider Microsoft-Windows-Security-Auditing 
</code></pre><p>then:</p><pre><code>$logs.events | where-object {$_.id -eq EVENT_ID} | fl *
</code></pre><p>&ndash; Don&rsquo;t Forget to Replace EVENT_ID with the event id that you want to get data about.</p><h1 id=channels-of-interest-for-the-analyst>Channels of Interest for the analyst<a hidden class=anchor aria-hidden=true href=#channels-of-interest-for-the-analyst>#</a></h1><p><img loading=lazy src=https://i.imgur.com/B8itb5U.png alt="enter image description here"></p><h1 id=mapping-attck-to-windows-event-ids>Mapping ATT&CK to Windows Event IDs<a hidden class=anchor aria-hidden=true href=#mapping-attck-to-windows-event-ids>#</a></h1><p>Indicators of attack (IOA) uses security operations to identify risks and map them to the most appropriate attack. In order to address different security scenarios with your SIEM, the link below maps Windows Event ID by tactic and technique.</p><p>©️ Author/Credits: <a href=https://twitter.com/mdecrevoisier>@mdecrevoisier</a></p><p><a href=https://github.com/mdecrevoisier/EVTX-to-MITRE-Attack>EVTX-to-MITRE-Attack</a></p><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p><img loading=lazy src=https://i.imgur.com/un3BuS6.png alt="enter image description here"></p><hr><p>&ndash; Resources i used for this topic</p><ul><li>SANS</li><li>loggly</li><li>Microsoft</li></ul><p>&ndash; Thanks For Reading..</p><p>&ndash; Wait For Part 2 More Details Kerberos Authentication</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://r1ddll3.github.io/tags/soc/>SOC</a></li><li><a href=https://r1ddll3.github.io/tags/windows-logging/>Windows Logging</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on twitter" href="https://twitter.com/intent/tweet/?text=How%20Windows%20Logging%20Work&url=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f&hashtags=SOC%2cWindowsLogging"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f&title=How%20Windows%20Logging%20Work&summary=How%20Windows%20Logging%20Work&source=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f&title=How%20Windows%20Logging%20Work"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on whatsapp" href="https://api.whatsapp.com/send?text=How%20Windows%20Logging%20Work%20-%20https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share How Windows Logging Work on telegram" href="https://telegram.me/share/url?text=How%20Windows%20Logging%20Work&url=https%3a%2f%2fr1ddll3.github.io%2fdfir%2fsoc-tips%2fwindows-logging%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://r1ddll3.github.io>R1ddl3 Edition</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>